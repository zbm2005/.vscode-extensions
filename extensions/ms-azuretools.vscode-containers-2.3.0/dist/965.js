"use strict";exports.id=965,exports.ids=[965],exports.modules={1965:(e,t,r)=>{r.d(t,{pj:()=>RestError,N$:()=>bearerTokenAuthenticationPolicy,uQ:()=>se,fl:()=>createDefaultHttpClient,O8:()=>createEmptyPipeline,createHttpHeaders:()=>createHttpHeaders,Fp:()=>createPipelineFromOptions,createPipelineRequest:()=>createPipelineRequest,e4:()=>O,ur:()=>defaultRetryPolicy,nV:()=>getDefaultProxySettings,T0:()=>isRestError,Ou:()=>d,Jb:()=>retryPolicy_retryPolicy,z7:()=>userAgentPolicy});const n=new Set(["Deserialize","Serialize","Retry","Sign"]);class HttpPipeline{constructor(e){var t;this._policies=[],this._policies=null!==(t=null==e?void 0:e.slice(0))&&void 0!==t?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!n.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!n.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){const t=[];return this._policies=this._policies.filter((r=>!(e.name&&r.policy.name===e.name||e.phase&&r.options.phase===e.phase)||(t.push(r.policy),!1))),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight(((e,t)=>r=>t.sendRequest(r,e)),(t=>e.sendRequest(t)))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new HttpPipeline(this._policies)}static create(){return new HttpPipeline}orderPolicies(){const e=[],t=new Map;function createPhase(e){return{name:e,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const r=createPhase("Serialize"),n=createPhase("None"),o=createPhase("Deserialize"),s=createPhase("Retry"),i=createPhase("Sign"),a=[r,n,o,s,i];function getPhase(e){return"Retry"===e?s:"Serialize"===e?r:"Deserialize"===e?o:"Sign"===e?i:n}for(const e of this._policies){const r=e.policy,n=e.options,o=r.name;if(t.has(o))throw new Error("Duplicate policy names not allowed in pipeline");const s={policy:r,dependsOn:new Set,dependants:new Set};n.afterPhase&&(s.afterPhase=getPhase(n.afterPhase),s.afterPhase.hasAfterPolicies=!0),t.set(o,s);getPhase(n.phase).policies.add(s)}for(const e of this._policies){const{policy:r,options:n}=e,o=r.name,s=t.get(o);if(!s)throw new Error(`Missing node for policy ${o}`);if(n.afterPolicies)for(const e of n.afterPolicies){const r=t.get(e);r&&(s.dependsOn.add(r),r.dependants.add(s))}if(n.beforePolicies)for(const e of n.beforePolicies){const r=t.get(e);r&&(r.dependsOn.add(s),s.dependants.add(r))}}function walkPhase(r){r.hasRun=!0;for(const n of r.policies)if((!n.afterPhase||n.afterPhase.hasRun&&!n.afterPhase.policies.size)&&0===n.dependsOn.size){e.push(n.policy);for(const e of n.dependants)e.dependsOn.delete(n);t.delete(n.policy.name),r.policies.delete(n)}}function walkPhases(){for(const e of a){if(walkPhase(e),e.policies.size>0&&e!==n)return void(n.hasRun||walkPhase(n));e.hasAfterPolicies&&walkPhase(n)}}let c=0;for(;t.size>0;){c++;const t=e.length;if(walkPhases(),e.length<=t&&c>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}function createEmptyPipeline(){return HttpPipeline.create()}var o=r(5136);const s=(0,o.KV)("core-rest-pipeline");var i=r(10151);const a="REDACTED",c=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],u=["api-version"];class Sanitizer{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=c.concat(e),t=u.concat(t),this.allowedHeaderNames=new Set(e.map((e=>e.toLowerCase()))),this.allowedQueryParameters=new Set(t.map((e=>e.toLowerCase())))}sanitize(e){const t=new Set;return JSON.stringify(e,((e,r)=>{if(r instanceof Error)return Object.assign(Object.assign({},r),{name:r.name,message:r.message});if("headers"===e)return this.sanitizeHeaders(r);if("url"===e)return this.sanitizeUrl(r);if("query"===e)return this.sanitizeQuery(r);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(r)||(0,i.Gv)(r)){if(t.has(r))return"[Circular]";t.add(r)}return r}}),2)}sanitizeUrl(e){if("string"!=typeof e||null===e||""===e)return e;const t=new URL(e);if(!t.search)return e;for(const[e]of t.searchParams)this.allowedQueryParameters.has(e.toLowerCase())||t.searchParams.set(e,a);return t.toString()}sanitizeHeaders(e){const t={};for(const r of Object.keys(e))this.allowedHeaderNames.has(r.toLowerCase())?t[r]=e[r]:t[r]=a;return t}sanitizeQuery(e){if("object"!=typeof e||null===e)return e;const t={};for(const r of Object.keys(e))this.allowedQueryParameters.has(r.toLowerCase())?t[r]=e[r]:t[r]=a;return t}}const l="logPolicy";const d="redirectPolicy",p=["GET","HEAD"];function redirectPolicy(e={}){const{maxRetries:t=20}=e;return{name:d,async sendRequest(e,r){const n=await r(e);return handleRedirect(r,n,t)}}}async function handleRedirect(e,t,r,n=0){const{request:o,status:s,headers:i}=t,a=i.get("location");if(a&&(300===s||301===s&&p.includes(o.method)||302===s&&p.includes(o.method)||303===s&&"POST"===o.method||307===s)&&n<r){const t=new URL(a,o.url);o.url=t.toString(),303===s&&(o.method="GET",o.headers.delete("Content-Length"),delete o.body),o.headers.delete("Authorization");const i=await e(o);return handleRedirect(e,i,r,n+1)}return t}var f=r(48161),h=r(1708),y=r.t(h,2);const g="1.19.1",m=3;async function getUserAgentValue(e){const t=new Map;t.set("core-rest-pipeline",g),await async function setPlatformSpecificData(e){if(y&&h.versions){const t=h.versions;t.bun?e.set("Bun",t.bun):t.deno?e.set("Deno",t.deno):t.node&&e.set("Node",t.node)}e.set("OS",`(${f.arch()}-${f.type()}-${f.release()})`)}(t);const r=function getUserAgentString(e){const t=[];for(const[r,n]of e){const e=n?`${r}/${n}`:r;t.push(e)}return t.join(" ")}(t);return e?`${e} ${r}`:r}const b="User-Agent",v="userAgentPolicy";function userAgentPolicy(e={}){const t=getUserAgentValue(e.userAgentPrefix);return{name:v,sendRequest:async(e,r)=>(e.headers.has(b)||e.headers.set(b,await t),r(e))}}var w=r(31635),P=r(57075);function isBlob(e){return"function"==typeof e.stream}const R=Symbol("rawContent");function getRawContent(e){return function hasRawContent(e){return"function"==typeof e[R]}(e)?e[R]():e.stream()}function streamAsyncIterator(){return(0,w.AQ)(this,arguments,(function*streamAsyncIterator_1(){const e=this.getReader();try{for(;;){const{done:t,value:r}=yield(0,w.N3)(e.read());if(t)return yield(0,w.N3)(void 0);yield yield(0,w.N3)(r)}}finally{e.releaseLock()}}))}function ensureNodeStream(e){return e instanceof ReadableStream?(function makeAsyncIterable(e){e[Symbol.asyncIterator]||(e[Symbol.asyncIterator]=streamAsyncIterator.bind(e)),e.values||(e.values=streamAsyncIterator.bind(e))}(e),P.Readable.fromWeb(e)):e}function toStream(e){return e instanceof Uint8Array?P.Readable.from(Buffer.from(e)):isBlob(e)?toStream(getRawContent(e)):ensureNodeStream(e)}function encodeHeaders(e){let t="";for(const[r,n]of e)t+=`${r}: ${n}\r\n`;return t}function getLength(e){return e instanceof Uint8Array?e.byteLength:isBlob(e)?-1===e.size?void 0:e.size:void 0}async function buildRequestBody(e,t,r){const n=[(0,i.Al)(`--${r}`,"utf-8"),...t.flatMap((e=>[(0,i.Al)("\r\n","utf-8"),(0,i.Al)(encodeHeaders(e.headers),"utf-8"),(0,i.Al)("\r\n","utf-8"),e.body,(0,i.Al)(`\r\n--${r}`,"utf-8")])),(0,i.Al)("--\r\n\r\n","utf-8")],o=function getTotalLength(e){let t=0;for(const r of e){const e=getLength(r);if(void 0===e)return;t+=e}return t}(n);o&&e.headers.set("Content-Length",o),e.body=await async function concat(e){return function(){const t=e.map((e=>"function"==typeof e?e():e)).map(toStream);return P.Readable.from(function(){return(0,w.AQ)(this,arguments,(function*(){var e,r,n,o;for(const c of t)try{for(var s,i=!0,a=(r=void 0,(0,w.xN)(c));!(e=(s=yield(0,w.N3)(a.next())).done);i=!0){o=s.value,i=!1;const e=o;yield yield(0,w.N3)(e)}}catch(e){r={error:e}}finally{try{i||e||!(n=a.return)||(yield(0,w.N3)(n.call(a)))}finally{if(r)throw r.error}}}))}())}}(n)}const S="multipartPolicy",A=70,x=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function multipartPolicy(){return{name:S,async sendRequest(e,t){var r;if(!e.multipartBody)return t(e);if(e.body)throw new Error("multipartBody and regular body cannot be set at the same time");let n=e.multipartBody.boundary;const o=null!==(r=e.headers.get("Content-Type"))&&void 0!==r?r:"multipart/mixed",s=o.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!s)throw new Error(`Got multipart request body, but content-type header was not multipart: ${o}`);const[,a,c]=s;if(c&&n&&c!==n)throw new Error(`Multipart boundary was specified as ${c} in the header, but got ${n} in the request body`);return null!=n||(n=c),n?function assertValidBoundary(e){if(e.length>A)throw new Error(`Multipart boundary "${e}" exceeds maximum length of 70 characters`);if(Array.from(e).some((e=>!x.has(e))))throw new Error(`Multipart boundary "${e}" contains invalid characters`)}(n):n=function generateBoundary(){return`----AzSDKFormBoundary${(0,i.N4)()}`}(),e.headers.set("Content-Type",`${a}; boundary=${n}`),await buildRequestBody(e,e.multipartBody.parts,n),e.multipartBody=void 0,t(e)}}}const O="decompressResponsePolicy";var C=r(42816);const E="The operation was aborted.";function delay(e,t,r){return new Promise(((n,o)=>{let s,i;const rejectOnAbort=()=>o(new C.l((null==r?void 0:r.abortErrorMsg)?null==r?void 0:r.abortErrorMsg:E)),removeListeners=()=>{(null==r?void 0:r.abortSignal)&&i&&r.abortSignal.removeEventListener("abort",i)};if(i=()=>(s&&clearTimeout(s),removeListeners(),rejectOnAbort()),(null==r?void 0:r.abortSignal)&&r.abortSignal.aborted)return rejectOnAbort();s=setTimeout((()=>{removeListeners(),n(t)}),e),(null==r?void 0:r.abortSignal)&&r.abortSignal.addEventListener("abort",i)}))}function parseHeaderValueAsNumber(e,t){const r=e.headers.get(t);if(!r)return;const n=Number(r);return Number.isNaN(n)?void 0:n}const _="Retry-After",T=["retry-after-ms","x-ms-retry-after-ms",_];function getRetryAfterInMs(e){if(e&&[429,503].includes(e.status))try{for(const t of T){const r=parseHeaderValueAsNumber(e,t);if(0===r||r){return r*(t===_?1e3:1)}}const t=e.headers.get(_);if(!t)return;const r=Date.parse(t)-Date.now();return Number.isFinite(r)?Math.max(0,r):void 0}catch(e){return}}const q=1e3,I=64e3;function exponentialRetryStrategy_exponentialRetryStrategy(e={}){var t,r;const n=null!==(t=e.retryDelayInMs)&&void 0!==t?t:q,o=null!==(r=e.maxRetryDelayInMs)&&void 0!==r?r:I;return{name:"exponentialRetryStrategy",retry({retryCount:t,response:r,responseError:s}){const a=function isSystemError(e){if(!e)return!1;return"ETIMEDOUT"===e.code||"ESOCKETTIMEDOUT"===e.code||"ECONNREFUSED"===e.code||"ECONNRESET"===e.code||"ENOENT"===e.code||"ENOTFOUND"===e.code}(s),c=a&&e.ignoreSystemErrors,u=function isExponentialRetryResponse(e){return Boolean(e&&void 0!==e.status&&(e.status>=500||408===e.status)&&501!==e.status&&505!==e.status)}(r),l=u&&e.ignoreHttpStatusCodes,d=r&&(function isThrottlingRetryResponse(e){return Number.isFinite(getRetryAfterInMs(e))}(r)||!u);return d||l||c?{skipStrategy:!0}:!s||a||u?(0,i.gE)(t,{retryDelayInMs:n,maxRetryDelayInMs:o}):{errorToThrow:s}}}}const H=(0,o.KV)("core-rest-pipeline retryPolicy"),k="retryPolicy";function retryPolicy_retryPolicy(e,t={maxRetries:m}){const r=t.logger||H;return{name:k,async sendRequest(n,o){var s,i;let a,c,u=-1;e:for(;;){u+=1,a=void 0,c=void 0;try{r.info(`Retry ${u}: Attempting to send request`,n.requestId),a=await o(n),r.info(`Retry ${u}: Received a response from request`,n.requestId)}catch(e){if(r.error(`Retry ${u}: Received an error from request`,n.requestId),c=e,!e||"RestError"!==c.name)throw e;a=c.response}if(null===(s=n.abortSignal)||void 0===s?void 0:s.aborted){r.error(`Retry ${u}: Request aborted.`);throw new C.l}if(u>=(null!==(i=t.maxRetries)&&void 0!==i?i:m)){if(r.info(`Retry ${u}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),c)throw c;if(a)return a;throw new Error("Maximum retries reached with no response or error to throw")}r.info(`Retry ${u}: Processing ${e.length} retry strategies.`);t:for(const t of e){const e=t.logger||H;e.info(`Retry ${u}: Processing retry strategy ${t.name}.`);const r=t.retry({retryCount:u,response:a,responseError:c});if(r.skipStrategy){e.info(`Retry ${u}: Skipped.`);continue t}const{errorToThrow:o,retryAfterInMs:s,redirectTo:i}=r;if(o)throw e.error(`Retry ${u}: Retry strategy ${t.name} throws error:`,o),o;if(s||0===s){e.info(`Retry ${u}: Retry strategy ${t.name} retries after ${s}`),await delay(s,void 0,{abortSignal:n.abortSignal});continue e}if(i){e.info(`Retry ${u}: Retry strategy ${t.name} redirects to ${i}`),n.url=i;continue e}}if(c)throw r.info("None of the retry strategies could work with the received error. Throwing it."),c;if(a)return r.info("None of the retry strategies could work with the received response. Returning it."),a}}}}const $="defaultRetryPolicy";function defaultRetryPolicy(e={}){var t;return{name:$,sendRequest:retryPolicy_retryPolicy([{name:"throttlingRetryStrategy",retry({response:e}){const t=getRetryAfterInMs(e);return Number.isFinite(t)?{retryAfterInMs:t}:{skipStrategy:!0}}},exponentialRetryStrategy_exponentialRetryStrategy(e)],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:m}).sendRequest}}function normalizeName(e){return e.toLowerCase()}class HttpHeadersImpl{constructor(e){if(this._headersMap=new Map,e)for(const t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(normalizeName(e),{name:e,value:String(t).trim()})}get(e){var t;return null===(t=this._headersMap.get(normalizeName(e)))||void 0===t?void 0:t.value}has(e){return this._headersMap.has(normalizeName(e))}delete(e){this._headersMap.delete(normalizeName(e))}toJSON(e={}){const t={};if(e.preserveCase)for(const e of this._headersMap.values())t[e.name]=e.value;else for(const[e,r]of this._headersMap)t[e]=r.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*headerIterator(e){for(const t of e.values())yield[t.name,t.value]}(this._headersMap)}}function createHttpHeaders(e){return new HttpHeadersImpl(e)}const L="formDataPolicy";function formDataPolicy(){return{name:L,async sendRequest(e,t){if(i.qx&&"undefined"!=typeof FormData&&e.body instanceof FormData&&(e.formData=function formDataToFormDataMap(e){var t;const r={};for(const[n,o]of e.entries())null!==(t=r[n])&&void 0!==t||(r[n]=[]),r[n].push(o);return r}(e.body),e.body=void 0),e.formData){const t=e.headers.get("Content-Type");t&&-1!==t.indexOf("application/x-www-form-urlencoded")?e.body=function wwwFormUrlEncode(e){const t=new URLSearchParams;for(const[r,n]of Object.entries(e))if(Array.isArray(n))for(const e of n)t.append(r,e.toString());else t.append(r,n.toString());return t.toString()}(e.formData):await async function prepareFormData(e,t){const r=t.headers.get("Content-Type");if(r&&!r.startsWith("multipart/form-data"))return;t.headers.set("Content-Type",null!=r?r:"multipart/form-data");const n=[];for(const[t,r]of Object.entries(e))for(const e of Array.isArray(r)?r:[r])if("string"==typeof e)n.push({headers:createHttpHeaders({"Content-Disposition":`form-data; name="${t}"`}),body:(0,i.Al)(e,"utf-8")});else{if(null==e||"object"!=typeof e)throw new Error(`Unexpected value for key ${t}: ${e}. Value should be serialized to string first.`);{const r=e.name||"blob",o=createHttpHeaders();o.set("Content-Disposition",`form-data; name="${t}"; filename="${r}"`),o.set("Content-Type",e.type||"application/octet-stream"),n.push({headers:o,body:e})}}t.multipartBody={parts:n}}(e.formData,e),e.formData=void 0}return t(e)}}}var j=r(62288),D=r(6645);const M="HTTPS_PROXY",N="HTTP_PROXY",B="ALL_PROXY",U="NO_PROXY",z="proxyPolicy",V=[];let W=!1;const F=new Map;function getEnvironmentValue(e){return process.env[e]?process.env[e]:process.env[e.toLowerCase()]?process.env[e.toLowerCase()]:void 0}function loadEnvironmentProxyValue(){if(!process)return;const e=getEnvironmentValue(M),t=getEnvironmentValue(B),r=getEnvironmentValue(N);return e||t||r}function getDefaultProxySettings(e){if(!e&&!(e=loadEnvironmentProxyValue()))return;const t=new URL(e);return{host:(t.protocol?t.protocol+"//":"")+t.hostname,port:Number.parseInt(t.port||"80"),username:t.username,password:t.password}}function getUrlFromProxySettings(e){let t;try{t=new URL(e.host)}catch(t){throw new Error(`Expecting a valid host string in proxy settings, but found "${e.host}".`)}return t.port=String(e.port),e.username&&(t.username=e.username),e.password&&(t.password=e.password),t}function setProxyAgentOnRequest(e,t,r){if(e.agent)return;const n="https:"!==new URL(e.url).protocol;e.tlsSettings&&s.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");const o=e.headers.toJSON();n?(t.httpProxyAgent||(t.httpProxyAgent=new D.HttpProxyAgent(r,{headers:o})),e.agent=t.httpProxyAgent):(t.httpsProxyAgent||(t.httpsProxyAgent=new j.HttpsProxyAgent(r,{headers:o})),e.agent=t.httpsProxyAgent)}function proxyPolicy(e,t){W||V.push(...function loadNoProxy(){const e=getEnvironmentValue(U);return W=!0,e?e.split(",").map((e=>e.trim())).filter((e=>e.length)):[]}());const r=e?getUrlFromProxySettings(e):function getDefaultProxySettingsInternal(){const e=loadEnvironmentProxyValue();return e?new URL(e):void 0}(),n={};return{name:z,async sendRequest(e,o){var s;return e.proxySettings||!r||function isBypassed(e,t,r){if(0===t.length)return!1;const n=new URL(e).hostname;if(null==r?void 0:r.has(n))return r.get(n);let o=!1;for(const e of t)"."===e[0]?(n.endsWith(e)||n.length===e.length-1&&n===e.slice(1))&&(o=!0):n===e&&(o=!0);return null==r||r.set(n,o),o}(e.url,null!==(s=null==t?void 0:t.customNoProxyList)&&void 0!==s?s:V,(null==t?void 0:t.customNoProxyList)?void 0:F)?e.proxySettings&&setProxyAgentOnRequest(e,n,getUrlFromProxySettings(e.proxySettings)):setProxyAgentOnRequest(e,n,r),o(e)}}}const G="setClientRequestIdPolicy";const Q="agentPolicy";const J="tlsPolicy";var K=r(11652);const X=r(57975).inspect.custom,Y=new Sanitizer;class RestError extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,Object.defineProperty(this,"request",{value:t.request,enumerable:!1}),Object.defineProperty(this,"response",{value:t.response,enumerable:!1}),Object.setPrototypeOf(this,RestError.prototype)}[X](){return`RestError: ${this.message} \n ${Y.sanitize(Object.assign(Object.assign({},this),{request:this.request,response:this.response}))}`}}function isRestError(e){return e instanceof RestError||(0,i.bJ)(e)&&"RestError"===e.name}RestError.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",RestError.PARSE_ERROR="PARSE_ERROR";const Z="tracingPolicy";function tracingPolicy(e={}){const t=getUserAgentValue(e.userAgentPrefix),r=new Sanitizer({additionalAllowedQueryParameters:e.additionalAllowedQueryParameters}),n=function tryCreateTracingClient(){try{return(0,K.y)({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:g})}catch(e){return void s.warning(`Error when creating the TracingClient: ${(0,i.u1)(e)}`)}}();return{name:Z,async sendRequest(e,o){var a;if(!n)return o(e);const c=await t,u={"http.url":r.sanitizeUrl(e.url),"http.method":e.method,"http.user_agent":c,requestId:e.requestId};c&&(u["http.user_agent"]=c);const{span:l,tracingContext:d}=null!==(a=function tryCreateSpan(e,t,r){try{const{span:n,updatedOptions:o}=e.startSpan(`HTTP ${t.method}`,{tracingOptions:t.tracingOptions},{spanKind:"client",spanAttributes:r});if(!n.isRecording())return void n.end();const s=e.createRequestHeaders(o.tracingOptions.tracingContext);for(const[e,r]of Object.entries(s))t.headers.set(e,r);return{span:n,tracingContext:o.tracingOptions.tracingContext}}catch(e){return void s.warning(`Skipping creating a tracing span due to an error: ${(0,i.u1)(e)}`)}}(n,e,u))&&void 0!==a?a:{};if(!l||!d)return o(e);try{const t=await n.withContext(d,o,e);return function tryProcessResponse(e,t){try{e.setAttribute("http.status_code",t.status);const r=t.headers.get("x-ms-request-id");r&&e.setAttribute("serviceRequestId",r),t.status>=400&&e.setStatus({status:"error"}),e.end()}catch(e){s.warning(`Skipping tracing span processing due to an error: ${(0,i.u1)(e)}`)}}(l,t),t}catch(e){throw function tryProcessError(e,t){try{e.setStatus({status:"error",error:(0,i.bJ)(t)?t:void 0}),isRestError(t)&&t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(e){s.warning(`Skipping tracing span processing due to an error: ${(0,i.u1)(e)}`)}}(l,e),e}}}}function createPipelineFromOptions(e){var t;const r=createEmptyPipeline();return i.qx&&(e.agent&&r.addPolicy(function agentPolicy(e){return{name:Q,sendRequest:async(t,r)=>(t.agent||(t.agent=e),r(t))}}(e.agent)),e.tlsOptions&&r.addPolicy(function tlsPolicy(e){return{name:J,sendRequest:async(t,r)=>(t.tlsSettings||(t.tlsSettings=e),r(t))}}(e.tlsOptions)),r.addPolicy(proxyPolicy(e.proxyOptions)),r.addPolicy(function decompressResponsePolicy(){return{name:O,sendRequest:async(e,t)=>("HEAD"!==e.method&&e.headers.set("Accept-Encoding","gzip,deflate"),t(e))}}())),r.addPolicy(formDataPolicy(),{beforePolicies:[S]}),r.addPolicy(userAgentPolicy(e.userAgentOptions)),r.addPolicy(function setClientRequestIdPolicy(e="x-ms-client-request-id"){return{name:G,sendRequest:async(t,r)=>(t.headers.has(e)||t.headers.set(e,t.requestId),r(t))}}(null===(t=e.telemetryOptions)||void 0===t?void 0:t.clientRequestIdHeaderName)),r.addPolicy(multipartPolicy(),{afterPhase:"Deserialize"}),r.addPolicy(defaultRetryPolicy(e.retryOptions),{phase:"Retry"}),r.addPolicy(tracingPolicy(Object.assign(Object.assign({},e.userAgentOptions),e.loggingOptions)),{afterPhase:"Retry"}),i.qx&&r.addPolicy(redirectPolicy(e.redirectOptions),{afterPhase:"Retry"}),r.addPolicy(function logPolicy(e={}){var t;const r=null!==(t=e.logger)&&void 0!==t?t:s.info,n=new Sanitizer({additionalAllowedHeaderNames:e.additionalAllowedHeaderNames,additionalAllowedQueryParameters:e.additionalAllowedQueryParameters});return{name:l,async sendRequest(e,t){if(!r.enabled)return t(e);r(`Request: ${n.sanitize(e)}`);const o=await t(e);return r(`Response status code: ${o.status}`),r(`Headers: ${n.sanitize(o.headers)}`),o}}}(e.loggingOptions),{afterPhase:"Sign"}),r}var ee=r(37067),te=r(44708),re=r(38522);const ne={};function nodeHttpClient_isReadableStream(e){return e&&"function"==typeof e.pipe}function isStreamComplete(e){return!1===e.readable?Promise.resolve():new Promise((t=>{const handler=()=>{t(),e.removeListener("close",handler),e.removeListener("end",handler),e.removeListener("error",handler)};e.on("close",handler),e.on("end",handler),e.on("error",handler)}))}function isArrayBuffer(e){return e&&"number"==typeof e.byteLength}class ReportTransform extends P.Transform{_transform(e,t,r){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),r()}catch(e){r(e)}}constructor(e){super(),this.loadedBytes=0,this.progressCallback=e}}class NodeHttpClient{constructor(){this.cachedHttpsAgents=new WeakMap}async sendRequest(e){var t,r,n;const o=new AbortController;let i,a;if(e.abortSignal){if(e.abortSignal.aborted)throw new C.l("The operation was aborted. Request has already been canceled.");i=e=>{"abort"===e.type&&o.abort()},e.abortSignal.addEventListener("abort",i)}e.timeout>0&&(a=setTimeout((()=>{const t=new Sanitizer;s.info(`request to '${t.sanitizeUrl(e.url)}' timed out. canceling...`),o.abort()}),e.timeout));const c=e.headers.get("Accept-Encoding"),u=(null==c?void 0:c.includes("gzip"))||(null==c?void 0:c.includes("deflate"));let l,d="function"==typeof e.body?e.body():e.body;if(d&&!e.headers.has("Content-Length")){const t=function getBodyLength(e){return e?Buffer.isBuffer(e)?e.length:nodeHttpClient_isReadableStream(e)?null:isArrayBuffer(e)?e.byteLength:"string"==typeof e?Buffer.from(e).length:null:0}(d);null!==t&&e.headers.set("Content-Length",t)}try{if(d&&e.onUploadProgress){const t=e.onUploadProgress,r=new ReportTransform(t);r.on("error",(e=>{s.error("Error in upload progress",e)})),nodeHttpClient_isReadableStream(d)?d.pipe(r):r.end(d),d=r}const i=await this.makeRequest(e,o,d);void 0!==a&&clearTimeout(a);const c=function getResponseHeaders(e){const t=createHttpHeaders();for(const r of Object.keys(e.headers)){const n=e.headers[r];Array.isArray(n)?n.length>0&&t.set(r,n[0]):n&&t.set(r,n)}return t}(i),p={status:null!==(t=i.statusCode)&&void 0!==t?t:0,headers:c,request:e};if("HEAD"===e.method)return i.resume(),p;l=u?function getDecodedResponseStream(e,t){const r=t.get("Content-Encoding");if("gzip"===r){const t=re.createGunzip();return e.pipe(t),t}if("deflate"===r){const t=re.createInflate();return e.pipe(t),t}return e}(i,c):i;const f=e.onDownloadProgress;if(f){const e=new ReportTransform(f);e.on("error",(e=>{s.error("Error in download progress",e)})),l.pipe(e),l=e}return(null===(r=e.streamResponseStatusCodes)||void 0===r?void 0:r.has(Number.POSITIVE_INFINITY))||(null===(n=e.streamResponseStatusCodes)||void 0===n?void 0:n.has(p.status))?p.readableStreamBody=l:p.bodyAsText=await function streamToText(e){return new Promise(((t,r)=>{const n=[];e.on("data",(e=>{Buffer.isBuffer(e)?n.push(e):n.push(Buffer.from(e))})),e.on("end",(()=>{t(Buffer.concat(n).toString("utf8"))})),e.on("error",(e=>{e&&"AbortError"===(null==e?void 0:e.name)?r(e):r(new RestError(`Error reading response as text: ${e.message}`,{code:RestError.PARSE_ERROR}))}))}))}(l),p}finally{if(e.abortSignal&&i){let t=Promise.resolve();nodeHttpClient_isReadableStream(d)&&(t=isStreamComplete(d));let r=Promise.resolve();nodeHttpClient_isReadableStream(l)&&(r=isStreamComplete(l)),Promise.all([t,r]).then((()=>{var t;i&&(null===(t=e.abortSignal)||void 0===t||t.removeEventListener("abort",i))})).catch((e=>{s.warning("Error when cleaning up abortListener on httpRequest",e)}))}}}makeRequest(e,t,r){var n;const o=new URL(e.url),i="https:"!==o.protocol;if(i&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);const a={agent:null!==(n=e.agent)&&void 0!==n?n:this.getOrCreateAgent(e,i),hostname:o.hostname,path:`${o.pathname}${o.search}`,port:o.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0})};return new Promise(((n,o)=>{const c=i?ee.request(a,n):te.request(a,n);c.once("error",(t=>{var r;o(new RestError(t.message,{code:null!==(r=t.code)&&void 0!==r?r:RestError.REQUEST_SEND_ERROR,request:e}))})),t.signal.addEventListener("abort",(()=>{const e=new C.l("The operation was aborted. Rejecting from abort signal callback while making request.");c.destroy(e),o(e)})),r&&nodeHttpClient_isReadableStream(r)?r.pipe(c):r?"string"==typeof r||Buffer.isBuffer(r)?c.end(r):isArrayBuffer(r)?c.end(ArrayBuffer.isView(r)?Buffer.from(r.buffer):Buffer.from(r)):(s.error("Unrecognized body type",r),o(new RestError("Unrecognized body type"))):c.end()}))}getOrCreateAgent(e,t){var r;const n=e.disableKeepAlive;if(t)return n?ee.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new ee.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(n&&!e.tlsSettings)return te.globalAgent;const t=null!==(r=e.tlsSettings)&&void 0!==r?r:ne;let o=this.cachedHttpsAgents.get(t);return o&&o.options.keepAlive===!n||(s.info("No cached TLS Agent exist, creating a new Agent"),o=new te.Agent(Object.assign({keepAlive:!n},t)),this.cachedHttpsAgents.set(t,o)),o}}}function createDefaultHttpClient(){return function createNodeHttpClient(){return new NodeHttpClient}()}class PipelineRequestImpl{constructor(e){var t,r,n,o,s,a,c;this.url=e.url,this.body=e.body,this.headers=null!==(t=e.headers)&&void 0!==t?t:createHttpHeaders(),this.method=null!==(r=e.method)&&void 0!==r?r:"GET",this.timeout=null!==(n=e.timeout)&&void 0!==n?n:0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=null!==(o=e.disableKeepAlive)&&void 0!==o&&o,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=null!==(s=e.withCredentials)&&void 0!==s&&s,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||(0,i.N4)(),this.allowInsecureConnection=null!==(a=e.allowInsecureConnection)&&void 0!==a&&a,this.enableBrowserStreams=null!==(c=e.enableBrowserStreams)&&void 0!==c&&c,this.agent=e.agent,this.tlsSettings=e.tlsSettings}}function createPipelineRequest(e){return new PipelineRequestImpl(e)}const oe={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function tokenCycler_createTokenCycler(e,t){let r,n=null,o=null;const s=Object.assign(Object.assign({},oe),t),i={get isRefreshing(){return null!==n},get shouldRefresh(){var e;return!i.isRefreshing&&(!!((null==o?void 0:o.refreshAfterTimestamp)&&o.refreshAfterTimestamp<Date.now())||(null!==(e=null==o?void 0:o.expiresOnTimestamp)&&void 0!==e?e:0)-s.refreshWindowInMs<Date.now())},get mustRefresh(){return null===o||o.expiresOnTimestamp-s.forcedRefreshWindowInMs<Date.now()}};function refresh(t,a){var c;if(!i.isRefreshing){n=async function beginRefresh(e,t,r){async function tryGetAccessToken(){if(!(Date.now()<r)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(e){return null}}let n=await tryGetAccessToken();for(;null===n;)await delay(t),n=await tryGetAccessToken();return n}((()=>e.getToken(t,a)),s.retryIntervalInMs,null!==(c=null==o?void 0:o.expiresOnTimestamp)&&void 0!==c?c:Date.now()).then((e=>(n=null,o=e,r=a.tenantId,o))).catch((e=>{throw n=null,o=null,r=void 0,e}))}return n}return async(e,t)=>{const n=Boolean(t.claims),s=r!==t.tenantId;n&&(o=null);return s||n||i.mustRefresh?refresh(e,t):(i.shouldRefresh&&refresh(e,t),o)}}const se="bearerTokenAuthenticationPolicy";async function trySendRequest(e,t){try{return[await t(e),void 0]}catch(e){if(isRestError(e)&&e.response)return[e.response,e];throw e}}async function defaultAuthorizeRequest(e){const{scopes:t,getAccessToken:r,request:n}=e,o={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions,enableCae:!0},s=await r(t,o);s&&e.request.headers.set("Authorization",`Bearer ${s.token}`)}function isChallengeResponse(e){return 401===e.status&&e.headers.has("WWW-Authenticate")}async function authorizeRequestOnCaeChallenge(e,t){var r;const{scopes:n}=e,o=await e.getAccessToken(n,{enableCae:!0,claims:t});return!!o&&(e.request.headers.set("Authorization",`${null!==(r=o.tokenType)&&void 0!==r?r:"Bearer"} ${o.token}`),!0)}function bearerTokenAuthenticationPolicy(e){var t,r,n;const{credential:o,scopes:i,challengeCallbacks:a}=e,c=e.logger||s,u={authorizeRequest:null!==(r=null===(t=null==a?void 0:a.authorizeRequest)||void 0===t?void 0:t.bind(a))&&void 0!==r?r:defaultAuthorizeRequest,authorizeRequestOnChallenge:null===(n=null==a?void 0:a.authorizeRequestOnChallenge)||void 0===n?void 0:n.bind(a)},l=o?tokenCycler_createTokenCycler(o):()=>Promise.resolve(null);return{name:se,async sendRequest(e,t){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let r,n,o;if(await u.authorizeRequest({scopes:Array.isArray(i)?i:[i],request:e,getAccessToken:l,logger:c}),[r,n]=await trySendRequest(e,t),isChallengeResponse(r)){let s=getCaeChallengeClaims(r.headers.get("WWW-Authenticate"));if(s){let a;try{a=atob(s)}catch(e){return c.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${s}`),r}o=await authorizeRequestOnCaeChallenge({scopes:Array.isArray(i)?i:[i],response:r,request:e,getAccessToken:l,logger:c},a),o&&([r,n]=await trySendRequest(e,t))}else if(u.authorizeRequestOnChallenge&&(o=await u.authorizeRequestOnChallenge({scopes:Array.isArray(i)?i:[i],request:e,response:r,getAccessToken:l,logger:c}),o&&([r,n]=await trySendRequest(e,t)),isChallengeResponse(r)&&(s=getCaeChallengeClaims(r.headers.get("WWW-Authenticate")),s))){let a;try{a=atob(s)}catch(e){return c.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${s}`),r}o=await authorizeRequestOnCaeChallenge({scopes:Array.isArray(i)?i:[i],response:r,request:e,getAccessToken:l,logger:c},a),o&&([r,n]=await trySendRequest(e,t))}}if(n)throw n;return r}}}function getCaeChallengeClaims(e){var t;if(!e)return;const r=function parseChallenges(e){const t=/(\w+)\s+((?:\w+=(?:"[^"]*"|[^,]*),?\s*)+)/g,r=/(\w+)="([^"]*)"/g,n=[];let o;for(;null!==(o=t.exec(e));){const e=o[1],t=o[2],s={};let i;for(;null!==(i=r.exec(t));)s[i[1]]=i[2];n.push({scheme:e,params:s})}return n}(e);return null===(t=r.find((e=>"Bearer"===e.scheme&&e.params.claims&&"insufficient_claims"===e.params.error)))||void 0===t?void 0:t.params.claims}},5136:(e,t,r)=>{r.d(t,{i2:()=>g,KV:()=>createClientLogger,XM:()=>getLogLevel,He:()=>setLogLevel});var n=r(48161),o=r(57975),s=r(1708);const i="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0;let a,c=[],u=[];const l=[];i&&enable(i);const d=Object.assign((e=>createDebugger(e)),{enable,enabled,disable:function disable(){const e=a||"";return enable(""),e},log:function log(e,...t){s.stderr.write(`${o.format(e,...t)}${n.EOL}`)}});function enable(e){a=e,c=[],u=[];const t=/\*/g,r=e.split(",").map((e=>e.trim().replace(t,".*?")));for(const e of r)e.startsWith("-")?u.push(new RegExp(`^${e.substr(1)}$`)):c.push(new RegExp(`^${e}$`));for(const e of l)e.enabled=enabled(e.namespace)}function enabled(e){if(e.endsWith("*"))return!0;for(const t of u)if(t.test(e))return!1;for(const t of c)if(t.test(e))return!0;return!1}function createDebugger(e){const t=Object.assign((function debug(...r){if(!t.enabled)return;r.length>0&&(r[0]=`${e} ${r[0]}`);t.log(...r)}),{enabled:enabled(e),destroy,log:d.log,namespace:e,extend});return l.push(t),t}function destroy(){const e=l.indexOf(this);return e>=0&&(l.splice(e,1),!0)}function extend(e){const t=createDebugger(`${this.namespace}:${e}`);return t.log=this.log,t}const p=d,f=new Set,h="undefined"!=typeof process&&process.env&&process.env.AZURE_LOG_LEVEL||void 0;let y;const g=p("azure");g.log=(...e)=>{p.log(...e)};const m=["verbose","info","warning","error"];function setLogLevel(e){if(e&&!isAzureLogLevel(e))throw new Error(`Unknown log level '${e}'. Acceptable values: ${m.join(",")}`);y=e;const t=[];for(const e of f)shouldEnable(e)&&t.push(e.namespace);p.enable(t.join(","))}function getLogLevel(){return y}h&&(isAzureLogLevel(h)?setLogLevel(h):console.error(`AZURE_LOG_LEVEL set to unknown log level '${h}'; logging is not enabled. Acceptable values: ${m.join(", ")}.`));const b={verbose:400,info:300,warning:200,error:100};function createClientLogger(e){const t=g.extend(e);return patchLogMethod(g,t),{error:createLogger(t,"error"),warning:createLogger(t,"warning"),info:createLogger(t,"info"),verbose:createLogger(t,"verbose")}}function patchLogMethod(e,t){t.log=(...t)=>{e.log(...t)}}function createLogger(e,t){const r=Object.assign(e.extend(t),{level:t});if(patchLogMethod(e,r),shouldEnable(r)){const e=p.disable();p.enable(e+","+r.namespace)}return f.add(r),r}function shouldEnable(e){return Boolean(y&&b[e.level]<=b[y])}function isAzureLogLevel(e){return m.includes(e)}},6645:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HttpProxyAgent=void 0;const a=s(r(69278)),c=s(r(64756)),u=i(r(45753)),l=r(24434),d=r(20917),p=r(87016),f=(0,u.default)("http-proxy-agent");class HttpProxyAgent extends d.Agent{constructor(e,t){super(t),this.proxy="string"==typeof e?new p.URL(e):e,this.proxyHeaders=t?.headers??{},f("Creating new HttpProxyAgent instance: %o",this.proxy.href);const r=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),n=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={...t?omit(t,"headers"):null,host:r,port:n}}addRequest(e,t){e._header=null,this.setRequestProps(e,t),super.addRequest(e,t)}setRequestProps(e,t){const{proxy:r}=this,n=`${t.secureEndpoint?"https:":"http:"}//${e.getHeader("host")||"localhost"}`,o=new p.URL(e.path,n);80!==t.port&&(o.port=String(t.port)),e.path=String(o);const s="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders};if(r.username||r.password){const e=`${decodeURIComponent(r.username)}:${decodeURIComponent(r.password)}`;s["Proxy-Authorization"]=`Basic ${Buffer.from(e).toString("base64")}`}s["Proxy-Connection"]||(s["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(const t of Object.keys(s)){const r=s[t];r&&e.setHeader(t,r)}}async connect(e,t){let r,n,o;return e._header=null,e.path.includes("://")||this.setRequestProps(e,t),f("Regenerating stored HTTP header string for request"),e._implicitHeader(),e.outputData&&e.outputData.length>0&&(f("Patching connection write() output buffer with updated header"),r=e.outputData[0].data,n=r.indexOf("\r\n\r\n")+4,e.outputData[0].data=e._header+r.substring(n),f("Output buffer: %o",e.outputData[0].data)),"https:"===this.proxy.protocol?(f("Creating `tls.Socket`: %o",this.connectOpts),o=c.connect(this.connectOpts)):(f("Creating `net.Socket`: %o",this.connectOpts),o=a.connect(this.connectOpts)),await(0,l.once)(o,"connect"),o}}function omit(e,...t){const r={};let n;for(n in e)t.includes(n)||(r[n]=e[n]);return r}HttpProxyAgent.protocols=["http","https"],t.HttpProxyAgent=HttpProxyAgent},10151:(e,t,r)=>{r.d(t,{gE:()=>calculateRetryDelay,cb:()=>delay,u1:()=>getErrorMessage,bJ:()=>isError,Ll:()=>f,qx:()=>p,Gv:()=>isObject,N4:()=>randomUUID,Al:()=>stringToUint8Array});var n=r(42816);const o="The delay was aborted.";function delay(e,t){let r;const{abortSignal:s,abortErrorMsg:i}=null!=t?t:{};return function createAbortablePromise(e,t){const{cleanupBeforeAbort:r,abortSignal:o,abortErrorMsg:s}=null!=t?t:{};return new Promise(((t,i)=>{function rejectOnAbort(){i(new n.l(null!=s?s:"The operation was aborted."))}function removeListeners(){null==o||o.removeEventListener("abort",onAbort)}function onAbort(){null==r||r(),removeListeners(),rejectOnAbort()}if(null==o?void 0:o.aborted)return rejectOnAbort();try{e((e=>{removeListeners(),t(e)}),(e=>{removeListeners(),i(e)}))}catch(e){i(e)}null==o||o.addEventListener("abort",onAbort)}))}((t=>{r=setTimeout(t,e)}),{cleanupBeforeAbort:()=>clearTimeout(r),abortSignal:s,abortErrorMsg:null!=i?i:o})}function calculateRetryDelay(e,t){const r=t.retryDelayInMs*Math.pow(2,e),n=Math.min(t.maxRetryDelayInMs,r);return{retryAfterInMs:n/2+function getRandomIntegerInclusive(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}(0,n/2)}}function isObject(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}function isError(e){if(isObject(e)){const t="string"==typeof e.name,r="string"==typeof e.message;return t&&r}return!1}function getErrorMessage(e){if(isError(e))return e.message;{let t;try{t="object"==typeof e&&e?JSON.stringify(e):String(e)}catch(e){t="[unable to stringify input]"}return`Unknown error ${t}`}}var s,i=r(76982);const a="function"==typeof(null===(s=null===globalThis||void 0===globalThis?void 0:globalThis.crypto)||void 0===s?void 0:s.randomUUID)?globalThis.crypto.randomUUID.bind(globalThis.crypto):i.randomUUID;function randomUUID(){return a()}var c,u,l,d;"undefined"!=typeof window&&window.document,"object"==typeof self&&"function"==typeof(null===self||void 0===self?void 0:self.importScripts)&&("DedicatedWorkerGlobalScope"===(null===(c=self.constructor)||void 0===c?void 0:c.name)||"ServiceWorkerGlobalScope"===(null===(u=self.constructor)||void 0===u?void 0:u.name)||null===(l=self.constructor)||void 0===l||l.name),"undefined"!=typeof Deno&&void 0!==Deno.version&&Deno.version.deno,"undefined"!=typeof Bun&&Bun.version;const p=void 0!==globalThis.process&&Boolean(globalThis.process.version)&&Boolean(null===(d=globalThis.process.versions)||void 0===d?void 0:d.node),f=p;"undefined"!=typeof navigator&&(null===navigator||void 0===navigator||navigator.product);function stringToUint8Array(e,t){return Buffer.from(e,t)}},11652:(e,t,r)=>{r.d(t,{y:()=>createTracingClient});const n={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function createTracingContext(e={}){let t=new TracingContextImpl(e.parentContext);return e.span&&(t=t.setValue(n.span,e.span)),e.namespace&&(t=t.setValue(n.namespace,e.namespace)),t}class TracingContextImpl{constructor(e){this._contextMap=e instanceof TracingContextImpl?new Map(e._contextMap):new Map}setValue(e,t){const r=new TracingContextImpl(this);return r._contextMap.set(e,t),r}getValue(e){return this._contextMap.get(e)}deleteValue(e){const t=new TracingContextImpl(this);return t._contextMap.delete(e),t}}const o=r(12583).w;function getInstrumenter(){return o.instrumenterImplementation||(o.instrumenterImplementation=function createDefaultInstrumenter(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{},addEvent:()=>{}},tracingContext:createTracingContext({parentContext:t.tracingContext})}),withContext:(e,t,...r)=>t(...r)}}()),o.instrumenterImplementation}function createTracingClient(e){const{namespace:t,packageName:r,packageVersion:o}=e;function startSpan(e,s,i){var a;const c=getInstrumenter().startSpan(e,Object.assign(Object.assign({},i),{packageName:r,packageVersion:o,tracingContext:null===(a=null==s?void 0:s.tracingOptions)||void 0===a?void 0:a.tracingContext}));let u=c.tracingContext;const l=c.span;u.getValue(n.namespace)||(u=u.setValue(n.namespace,t)),l.setAttribute("az.namespace",u.getValue(n.namespace));return{span:l,updatedOptions:Object.assign({},s,{tracingOptions:Object.assign(Object.assign({},null==s?void 0:s.tracingOptions),{tracingContext:u})})}}function withContext(e,t,...r){return getInstrumenter().withContext(e,t,...r)}return{startSpan,withSpan:async function withSpan(e,t,r,n){const{span:o,updatedOptions:s}=startSpan(e,t,n);try{const e=await withContext(s.tracingOptions.tracingContext,(()=>Promise.resolve(r(s,o))));return o.setStatus({status:"success"}),e}catch(e){throw o.setStatus({status:"error",error:e}),e}finally{o.end()}},withContext,parseTraceparentHeader:function parseTraceparentHeader(e){return getInstrumenter().parseTraceparentHeader(e)},createRequestHeaders:function createRequestHeaders(e){return getInstrumenter().createRequestHeaders(e)}}}},12583:(e,t)=>{t.w=void 0,t.w={instrumenterImplementation:void 0}},20544:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.req=t.json=t.toBuffer=void 0;const i=s(r(58611)),a=s(r(65692));async function toBuffer(e){let t=0;const r=[];for await(const n of e)t+=n.length,r.push(n);return Buffer.concat(r,t)}t.toBuffer=toBuffer,t.json=async function json(e){const t=(await toBuffer(e)).toString("utf8");try{return JSON.parse(t)}catch(e){const r=e;throw r.message+=` (input: ${t})`,r}},t.req=function req(e,t={}){const r=(("string"==typeof e?e:e.href).startsWith("https:")?a:i).request(e,t),n=new Promise(((e,t)=>{r.once("response",e).once("error",t).end()}));return r.then=n.then.bind(n),r}},20917:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.Agent=void 0;const a=s(r(69278)),c=s(r(58611)),u=r(65692);i(r(20544),t);const l=Symbol("AgentBaseInternalState");class Agent extends c.Agent{constructor(e){super(e),this[l]={}}isSecureEndpoint(e){if(e){if("boolean"==typeof e.secureEndpoint)return e.secureEndpoint;if("string"==typeof e.protocol)return"https:"===e.protocol}const{stack:t}=new Error;return"string"==typeof t&&t.split("\n").some((e=>-1!==e.indexOf("(https.js:")||-1!==e.indexOf("node:https:")))}incrementSockets(e){if(this.maxSockets===1/0&&this.maxTotalSockets===1/0)return null;this.sockets[e]||(this.sockets[e]=[]);const t=new a.Socket({writable:!1});return this.sockets[e].push(t),this.totalSocketCount++,t}decrementSockets(e,t){if(!this.sockets[e]||null===t)return;const r=this.sockets[e],n=r.indexOf(t);-1!==n&&(r.splice(n,1),this.totalSocketCount--,0===r.length&&delete this.sockets[e])}getName(e){return("boolean"==typeof e.secureEndpoint?e.secureEndpoint:this.isSecureEndpoint(e))?u.Agent.prototype.getName.call(this,e):super.getName(e)}createSocket(e,t,r){const n={...t,secureEndpoint:this.isSecureEndpoint(t)},o=this.getName(n),s=this.incrementSockets(o);Promise.resolve().then((()=>this.connect(e,n))).then((i=>{if(this.decrementSockets(o,s),i instanceof c.Agent)try{return i.addRequest(e,n)}catch(e){return r(e)}this[l].currentSocket=i,super.createSocket(e,t,r)}),(e=>{this.decrementSockets(o,s),r(e)}))}createConnection(){const e=this[l].currentSocket;if(this[l].currentSocket=void 0,!e)throw new Error("No socket was returned in the `connect()` function");return e}get defaultPort(){return this[l].defaultPort??("https:"===this.protocol?443:80)}set defaultPort(e){this[l]&&(this[l].defaultPort=e)}get protocol(){return this[l].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(e){this[l]&&(this[l].protocol=e)}}t.Agent=Agent},31635:(e,t,r)=>{r.d(t,{AQ:()=>__asyncGenerator,Me:()=>__asyncDelegator,N3:()=>__await,Tt:()=>__rest,sH:()=>__awaiter,xN:()=>__asyncValues});function __rest(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function __awaiter(e,t,r,n){return new(r||(r=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n.throw(e))}catch(e){s(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))}Object.create;function __values(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}function __asyncGenerator(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),s=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),verb("next"),verb("throw"),verb("return",(function awaitReturn(e){return function(t){return Promise.resolve(t).then(e,reject)}})),n[Symbol.asyncIterator]=function(){return this},n;function verb(e,t){o[e]&&(n[e]=function(t){return new Promise((function(r,n){s.push([e,t,r,n])>1||resume(e,t)}))},t&&(n[e]=t(n[e])))}function resume(e,t){try{!function step(e){e.value instanceof __await?Promise.resolve(e.value.v).then(fulfill,reject):settle(s[0][2],e)}(o[e](t))}catch(e){settle(s[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),s.shift(),s.length&&resume(s[0][0],s[0][1])}}function __asyncDelegator(e){var t,r;return t={},verb("next"),verb("throw",(function(e){throw e})),verb("return"),t[Symbol.iterator]=function(){return this},t;function verb(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:__await(e[n](t)),done:!1}:o?o(t):t}:o}}function __asyncValues(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=__values(e),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);function verb(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function settle(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}Object.create;"function"==typeof SuppressedError&&SuppressedError},42816:(e,t,r)=>{r.d(t,{l:()=>AbortError});class AbortError extends Error{constructor(e){super(e),this.name="AbortError"}}},62288:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HttpsProxyAgent=void 0;const a=s(r(69278)),c=s(r(64756)),u=i(r(42613)),l=i(r(45753)),d=r(20917),p=r(87016),f=r(63868),h=(0,l.default)("https-proxy-agent"),setServernameFromNonIpHost=e=>void 0===e.servername&&e.host&&!a.isIP(e.host)?{...e,servername:e.host}:e;class HttpsProxyAgent extends d.Agent{constructor(e,t){super(t),this.options={path:void 0},this.proxy="string"==typeof e?new p.URL(e):e,this.proxyHeaders=t?.headers??{},h("Creating new HttpsProxyAgent instance: %o",this.proxy.href);const r=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),n=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...t?omit(t,"headers"):null,host:r,port:n}}async connect(e,t){const{proxy:r}=this;if(!t.host)throw new TypeError('No "host" provided');let n;"https:"===r.protocol?(h("Creating `tls.Socket`: %o",this.connectOpts),n=c.connect(setServernameFromNonIpHost(this.connectOpts))):(h("Creating `net.Socket`: %o",this.connectOpts),n=a.connect(this.connectOpts));const o="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders},s=a.isIPv6(t.host)?`[${t.host}]`:t.host;let i=`CONNECT ${s}:${t.port} HTTP/1.1\r\n`;if(r.username||r.password){const e=`${decodeURIComponent(r.username)}:${decodeURIComponent(r.password)}`;o["Proxy-Authorization"]=`Basic ${Buffer.from(e).toString("base64")}`}o.Host=`${s}:${t.port}`,o["Proxy-Connection"]||(o["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(const e of Object.keys(o))i+=`${e}: ${o[e]}\r\n`;const l=(0,f.parseProxyResponse)(n);n.write(`${i}\r\n`);const{connect:d,buffered:p}=await l;if(e.emit("proxyConnect",d),this.emit("proxyConnect",d,e),200===d.statusCode)return e.once("socket",resume),t.secureEndpoint?(h("Upgrading socket connection to TLS"),c.connect({...omit(setServernameFromNonIpHost(t),"host","path","port"),socket:n})):n;n.destroy();const y=new a.Socket({writable:!1});return y.readable=!0,e.once("socket",(e=>{h("Replaying proxy buffer for failed request"),(0,u.default)(e.listenerCount("data")>0),e.push(p),e.push(null)})),y}}function resume(e){e.resume()}function omit(e,...t){const r={};let n;for(n in e)t.includes(n)||(r[n]=e[n]);return r}HttpsProxyAgent.protocols=["http","https"],t.HttpsProxyAgent=HttpsProxyAgent},63868:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.parseProxyResponse=void 0;const o=(0,n(r(45753)).default)("https-proxy-agent:parse-proxy-response");t.parseProxyResponse=function parseProxyResponse(e){return new Promise(((t,r)=>{let n=0;const s=[];function read(){const i=e.read();i?function ondata(i){s.push(i),n+=i.length;const a=Buffer.concat(s,n),c=a.indexOf("\r\n\r\n");if(-1===c)return o("have not received end of HTTP headers yet..."),void read();const u=a.slice(0,c).toString("ascii").split("\r\n"),l=u.shift();if(!l)return e.destroy(),r(new Error("No header received from proxy CONNECT response"));const d=l.split(" "),p=+d[1],f=d.slice(2).join(" "),h={};for(const t of u){if(!t)continue;const n=t.indexOf(":");if(-1===n)return e.destroy(),r(new Error(`Invalid header from proxy CONNECT response: "${t}"`));const o=t.slice(0,n).toLowerCase(),s=t.slice(n+1).trimStart(),i=h[o];"string"==typeof i?h[o]=[i,s]:Array.isArray(i)?i.push(s):h[o]=s}o("got proxy server response: %o %o",l,h),cleanup(),t({connect:{statusCode:p,statusText:f,headers:h},buffered:a})}(i):e.once("readable",read)}function cleanup(){e.removeListener("end",onend),e.removeListener("error",onerror),e.removeListener("readable",read)}function onend(){cleanup(),o("onend"),r(new Error("Proxy connection ended before receiving CONNECT response"))}function onerror(e){cleanup(),o("onerror %o",e),r(e)}e.on("error",onerror),e.on("end",onend),read()}))}}};